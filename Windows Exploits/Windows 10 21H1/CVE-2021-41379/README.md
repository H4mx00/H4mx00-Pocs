# PoC for CVE-2021-41379: Windows Print Spooler Vulnerability

## Overview
CVE-2021-41379 is a privilege escalation vulnerability in the Windows Print Spooler service. It allows local attackers to elevate their privileges to SYSTEM level by exploiting the way the Print Spooler handles certain requests.

- **CVE ID**: CVE-2021-41379
- **Severity**: High
- **Attack Vector**: Local
- **Exploit Type**: Privilege Escalation
- **Affected Systems**: Various Windows versions, including Windows 10 and Windows Server 2019 (verify affected versions per Microsoftâ€™s official advisory).

## Requirements
To exploit this vulnerability, an attacker must have local access to the target system. The exploit typically requires:
- Administrative privileges or local access to run malicious commands.
- Access to the Print Spooler service.

**Example Video of Vulnerable Environment Setup:**

[POC](CVE-2021-41379.mp4)

## Exploit Steps
### Step 1: Set up the Vulnerable Environment
Ensure the test environment runs a version of Windows with the Print Spooler service enabled and an unpatched version vulnerable to CVE-2021-41379. The configurations include:
- **OS Version**: Windows 10 **21H1 19043.928**
- **Patch Level**: Ensure the system does not have security updates installed post-October 2021 (KB5006738 mitigates this vulnerability).

### Step 2: Exploitation Steps
1. **Trigger the Vulnerability**: Exploit the Print Spooler service by sending specially crafted requests to the service.
    - This typically involves using the `AddPrinterDriverEx` API to load a malicious driver.
2. **Load a Malicious DLL**: Create and load a malicious DLL that grants elevated privileges.
3. **Escalate Privileges**: Execute code as SYSTEM by taking control of a process with higher privileges.

## Testing and Validation
1. **Compile and Run the Exploit**:
   ```bash
InstallerFileTakeOver.exe
```